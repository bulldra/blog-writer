-   [x] Reasoning を最終プロンプト同様に折りたたみ表示に対応
-   [x] UI コンポーネントを分割（Collapsible 導入）
-   [x] 生成結果は単一プレビューに統一し、ソース（Markdown）は折りたたみで表示
-   [x] Collapsible にプレビューを追加（閉時にプレビュー表示）
-   [x] 最終プロンプト・Reasoning・ソースにプレビュー適用
-   [x] プレビュー行数を 3 行に調整（末尾表示は必要箇所のみ）
-   [x] 最終プロンプトは最終行ではなく最初の行
-   [x] リーズニングのスクロールは展開時にも同期
-   [x] 記事テンプレート「選択しない」を廃止。初回は先頭自動選択、選択は localStorage に保存
-   [x] ソースコードのスクロールはプレビュー位置に同期
-   [x] reasoning の展開時は markdown のマークアップを適用、展開前はプレーンテキスト
-   [x] reasoning の折りたたみ時の縦幅を自動調整せずに固定（72px）
-   [x] 最終プロンプトは prompt へ
-   [x] prompt の展開時は markdown のマークアップを適用、展開前はプレーンテキスト
-   [x] 記事テンプレートの選択をコンポーネント化
-   [x] コンポーネントの番号づけをを廃止
-   [x] 編集依頼のコンポーネントを切り出し
-   [x] 記事生成の追加指示は TODO リストで管理するシステムとする
-   [x] 「TODO で生成」ボタンを追加（既存の生成と同ハンドラで実行）
-   [x] プロパティ入力 → プランニング（AI）→ プラン修正 → プラン実行（AI）→ 記事生成（AI）
-   [x] プラン実行時に AI が TODO の生成と準拠を確認してリストを更新
-   [x] プラン自体は編集しない
-   [x] TODO リストの各項目に完了チェックボックスを追加
-   [x] TODO は plan の下側に自動生成
-   [x] 追加の指示（任意・固定化しません）は削除
-   [x] TODO は完了チェックボックスを追加し、完了したら打ち消し線を引く
-   [x] TODO は人間が自由に更新可能
-   [x] TODO の更新を人間がして生成を依頼することで記事を完成に近づける
-   [x] TODO を元にプロンプトを生成する
-   [x] UI のコンポーネント化をさらに推進
-   [x] 横幅を固定せずにレスポンシブ対応
-   [x] Kindle ウィジェットの構成変更: 書籍選択時に全ハイライトを取り込み対象とすることを明確化
-   [x] テンプレート削除ボタンはテンプレート名の左側に配置
-   [x] 変数名はタイトルの右側に置いて、縦幅を節約
-   [x] ウィジットに基づく提案中はローディング中であることをを分かるようにする
-   [x] ウィジットに基づく提案中は、ウィジットの選択をブロックする
-   [x] 変数名をクリックしたときに、変数名を挿入する
-   [x] test コードを test 配下の適切なサブディレクトリに移動
-   [x] 記事のメタデータやカスタムフィールドを設定します の説明は不要
-   [x] テストコードを整理、共通化
-   [x] テストコードのカバレッジを向上
-   [x] テストコードのカバレッジを測定する仕組みを導入
-   [x] プロパティセットには日付入力と選択肢入力を追加
-   [x] ウィジットに基づく提案はストリーミングで反映
-   [x] いい回しと辞書のサイドバー削除
-   [x] component への分割、整理、共通化リファクタリング
-   [x] 不要コードを削除
-   [x] pytest 実行
-   [x] selenium と chrome driver でスクレイピングするウィジェット（通常のスクレイピングと分けて管理）
-   [x] ruff, mypy, black 実行
-   [x] tasks.md 更新
-   [x] pytest では LLM をモック化（autouse fixture で app.ai_utils / app.routers.ai をスタブ）
-   [x] writer 画面でのウィジェット管理や編集は不要
-   [x] writer 画面でのプロパティ、例えば書籍タイトルはなどはプロパティセットで設定するので不要
-   [x] writer 画面でのウィジェットは記事生成のための情報収集に使うので、plan の前に配置
-   [x] selenium でスクリーンショットを撮って
        入力に使うウィジェット（バックエンド: Gemini 経路へ画像添付対応） - routers/ai: ウィジェット処理の返却を (text, media) に拡張し、
        genai_types.Blob で画像を添付 - LM Studio 経路は従来どおりテキストのみ - UI プレビューとフロントからの指定（mode: screenshot/both）は現状反映済み。
        画像の UI プレビューは別途実装（TODO 継続）
-   [x] 追加可能なウィジェットについて一覧するのではなくコンボボックスで選択できるようにする
-   [x] テンプレート管理ページで未使用ウィジェットを select から選択 → 追加
-   [x] 既存のドラッグ&ドロップ順序入替は維持
-   [x] 記事テンプレート管理画面は最初に一覧のみ表示して、選択したら詳細画面に遷移する
-   [x] 一覧画面では表形式で情報を表示し、編集・削除ボタンを配置
-   [x] 詳細画面に一覧用の説明文フィールドを追加
-   [x] 一覧画面の説明文は折りたたみ表示
-   [x] テンプレートの複製機能を追加
-   [x] テンプレート一覧に検索・ソートを追加
-   [x] テンプレート一覧のウィジェット表示をタグ化
-   [ ] スクリーンショット画像の UI プレビューを追加（writer/AI の入出力）
-   [ ] 詳細画面で説明文の AI 提案（自動入力）を追加
-   [ ] テンプレート一覧の編集リンクは不要で、行クリックで詳細画面に遷移
-   [x] task.md の随時実行システムを実装
